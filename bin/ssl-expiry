#!/bin/sh

ssl_expiry() {
    # Show usage info if not called with a hostname
    if [ $# -eq 0 ]; then
        echo "Usage: ssl_expiry HOSTNAME"
        return 0
    fi

    domain=$1
    output=$(echo | openssl s_client -connect ${domain}:443 2>/dev/null | openssl x509 -enddate -noout)
    end_date=${output##*=}
    echo $domain $end_date
}

for DOMAIN in "$@"
do
    ssl_expiry $DOMAIN
done
